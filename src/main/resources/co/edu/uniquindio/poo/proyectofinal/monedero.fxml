<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/8"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="co.edu.uniquindio.poo.proyectofinal.viewController.MonederoControlador"
            prefWidth="1000.0" prefHeight="650.0"
            stylesheets="@styles.css">

    <!-- =============== BARRA SUPERIOR ================= -->
    <top>
        <HBox spacing="15"
              alignment="CENTER_LEFT"
              styleClass="header-bar"
              BorderPane.alignment="CENTER">
            <padding>
                <Insets top="10" right="20" bottom="10" left="20"/>
            </padding>
            <children>
                <Label text="Monedero Virtual" styleClass="header-title">
                    <font>
                        <Font size="22.0"/>
                    </font>
                </Label>
                <Region HBox.hgrow="ALWAYS"/>

                <Label text="Bienvenido," styleClass="header-subtitle"/>

                <!-- ÚNICA etiqueta con fx:id = labelClienteNombre -->
                <Label fx:id="labelClienteNombre"
                       text="Nombre Cliente"
                       styleClass="header-client-name">
                    <font>
                        <Font size="16.0"/>
                    </font>
                </Label>

                <Button fx:id="btnLogout"
                        text="Cerrar sesión"
                        onAction="#handleLogout"
                        styleClass="secondary-button"/>
            </children>
        </HBox>
    </top>

    <!-- =============== CONTENIDO CENTRAL ================= -->
    <center>
        <HBox spacing="20"
              BorderPane.alignment="CENTER">
            <padding>
                <Insets top="20" right="20" bottom="20" left="20"/>
            </padding>

            <children>


                <VBox spacing="12"
                      styleClass="card"
                      HBox.hgrow="NEVER">
                    <children>
                        <Label text="Resumen del cliente"
                               styleClass="card-title"/>

                        <VBox spacing="4">
                            <children>
                                <Label text="Cliente" styleClass="field-label"/>
                                <!-- Segunda etiqueta para el nombre, con otro fx:id -->
                                <Label fx:id="labelClienteNombreDetalle"
                                       text="Nombre Cliente"
                                       styleClass="field-value"/>
                            </children>
                        </VBox>

                        <Separator/>

                        <VBox spacing="8">
                            <children>
                                <Label text="Saldo actual" styleClass="field-label"/>
                                <Label fx:id="labelSaldoActual"
                                       text="0.00"
                                       styleClass="saldo-label"/>
                            </children>
                        </VBox>

                        <VBox spacing="8">
                            <children>
                                <Label text="Puntos acumulados" styleClass="field-label"/>
                                <Label fx:id="labelPuntos"
                                       text="0"
                                       styleClass="points-label"/>
                            </children>
                        </VBox>

                        <VBox spacing="8">
                            <children>
                                <Label text="Rango del cliente" styleClass="field-label"/>
                                <Label fx:id="labelRango"
                                       text="Básico"
                                       styleClass="status-label"/>
                            </children>
                        </VBox>

                        <Separator/>

                        <VBox spacing="6">
                            <children>
                                <Label text="Monedero seleccionado" styleClass="field-label"/>
                                <ComboBox fx:id="comboMonederos"
                                          promptText="Seleccionar monedero"
                                          prefWidth="180.0"/>
                            </children>
                        </VBox>
                    </children>
                </VBox>


                <TabPane tabClosingPolicy="UNAVAILABLE"
                         HBox.hgrow="ALWAYS">
                    <tabs>

                        <!-- ===== TAB: MOVIMIENTOS ===== -->
                        <Tab text="Movimientos">
                            <content>
                                <VBox spacing="15"
                                      styleClass="card">
                                    <children>
                                        <Label text="Gestión de movimientos"
                                               styleClass="card-title"/>

                                        <GridPane hgap="12" vgap="10">
                                            <columnConstraints>
                                                <ColumnConstraints percentWidth="35"/>
                                                <ColumnConstraints percentWidth="65"/>
                                            </columnConstraints>

                                            <children>
                                                <!-- Depósito -->
                                                <Label text="Monto depósito:"
                                                       GridPane.rowIndex="0" GridPane.columnIndex="0"
                                                       styleClass="field-label"/>
                                                <HBox spacing="8"
                                                      GridPane.rowIndex="0" GridPane.columnIndex="1">
                                                    <children>
                                                        <TextField fx:id="fieldDepositoMonto"
                                                                   promptText="Ej: 50000"
                                                                   HBox.hgrow="ALWAYS"/>
                                                        <Button fx:id="btnDepositar"
                                                                text="Depositar"
                                                                onAction="#handleDepositar"
                                                                styleClass="primary-button"/>
                                                    </children>
                                                </HBox>

                                                <!-- Retiro -->
                                                <Label text="Monto retiro:"
                                                       GridPane.rowIndex="1" GridPane.columnIndex="0"
                                                       styleClass="field-label"/>
                                                <HBox spacing="8"
                                                      GridPane.rowIndex="1" GridPane.columnIndex="1">
                                                    <children>
                                                        <TextField fx:id="fieldRetiroMonto"
                                                                   promptText="Ej: 20000"
                                                                   HBox.hgrow="ALWAYS"/>
                                                        <Button fx:id="btnRetirar"
                                                                text="Retirar"
                                                                onAction="#handleRetirar"
                                                                styleClass="primary-button"/>
                                                    </children>
                                                </HBox>

                                                <!-- Transferencia -->
                                                <Label text="Monto transferencia:"
                                                       GridPane.rowIndex="2" GridPane.columnIndex="0"
                                                       styleClass="field-label"/>
                                                <TextField fx:id="fieldTransferMonto"
                                                           promptText="Ej: 30000"
                                                           GridPane.rowIndex="2" GridPane.columnIndex="1"/>

                                                <Label text="Destino transferencia:"
                                                       GridPane.rowIndex="3" GridPane.columnIndex="0"
                                                       styleClass="field-label"/>
                                                <HBox spacing="8"
                                                      GridPane.rowIndex="3" GridPane.columnIndex="1">
                                                    <children>
                                                        <TextField fx:id="fieldTransferDestino"
                                                                   promptText="ID o usuario destino"
                                                                   HBox.hgrow="ALWAYS"/>
                                                        <Button fx:id="btnTransferir"
                                                                text="Transferir"
                                                                onAction="#handleTransferir"
                                                                styleClass="primary-button"/>
                                                    </children>
                                                </HBox>
                                            </children>
                                        </GridPane>

                                        <Label text="Los movimientos exitosos se registrarán en la actividad de abajo."
                                               styleClass="hint-label"/>
                                    </children>
                                </VBox>
                            </content>
                        </Tab>

                        <!-- ===== TAB: PROGRAMAR TRANSACCIÓN ===== -->
                        <Tab text="Programar">
                            <content>
                                <VBox spacing="15"
                                      styleClass="card">
                                    <children>
                                        <Label text="Programar transacción"
                                               styleClass="card-title"/>

                                        <GridPane hgap="12" vgap="10">
                                            <columnConstraints>
                                                <ColumnConstraints percentWidth="35"/>
                                                <ColumnConstraints percentWidth="65"/>
                                            </columnConstraints>

                                            <children>
                                                <Label text="Monto:"
                                                       GridPane.rowIndex="0" GridPane.columnIndex="0"
                                                       styleClass="field-label"/>
                                                <TextField fx:id="fieldMontoProgramado"
                                                           promptText="Ej: 100000"
                                                           GridPane.rowIndex="0" GridPane.columnIndex="1"/>

                                                <Label text="Destino:"
                                                       GridPane.rowIndex="1" GridPane.columnIndex="0"
                                                       styleClass="field-label"/>
                                                <TextField fx:id="fieldDestinoProgramado"
                                                           promptText="ID o usuario destino"
                                                           GridPane.rowIndex="1" GridPane.columnIndex="1"/>

                                                <Label text="Fecha ejecución:"
                                                       GridPane.rowIndex="2" GridPane.columnIndex="0"
                                                       styleClass="field-label"/>
                                                <DatePicker fx:id="datePickerFecha"
                                                            GridPane.rowIndex="2" GridPane.columnIndex="1"/>

                                                <Label text="Periodicidad:"
                                                       GridPane.rowIndex="3" GridPane.columnIndex="0"
                                                       styleClass="field-label"/>
                                                <ComboBox fx:id="comboPeriodicidad"
                                                          promptText="Selecciona periodicidad"
                                                          GridPane.rowIndex="3" GridPane.columnIndex="1"/>
                                            </children>
                                        </GridPane>

                                        <HBox spacing="10"
                                              alignment="CENTER_RIGHT">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <Button fx:id="btnProgramarTx"
                                                        text="Programar transacción"
                                                        onAction="#handleProgramarTransferencia"
                                                        styleClass="primary-button"/>
                                            </children>
                                        </HBox>
                                    </children>
                                </VBox>
                            </content>
                        </Tab>

                        <!-- ===== TAB: BENEFICIOS ===== -->
                        <Tab text="Beneficios">
                            <content>
                                <VBox spacing="15"
                                      styleClass="card">
                                    <children>
                                        <Label text="Beneficios disponibles"
                                               styleClass="card-title"/>

                                        <ListView fx:id="listBeneficios"
                                                  VBox.vgrow="ALWAYS"/>

                                        <HBox spacing="10" alignment="CENTER_RIGHT">
                                            <children>
                                                <Label text="Selecciona un beneficio para canjear."
                                                       styleClass="hint-label"
                                                       HBox.hgrow="ALWAYS"/>
                                                <Button fx:id="btnCanjear"
                                                        text="Canjear beneficio"
                                                        onAction="#handleCanjearBeneficio"
                                                        styleClass="primary-button"/>
                                            </children>
                                        </HBox>
                                    </children>
                                </VBox>
                            </content>
                        </Tab>

                        <!-- ===== TAB: ANALÍTICA ===== -->
                        <Tab text="Analítica">
                            <content>
                                <VBox spacing="15"
                                      styleClass="card">
                                    <children>
                                        <Label text="Análisis del monedero"
                                               styleClass="card-title"/>

                                        <Label text="Ejecuta un análisis para ver estadísticas avanzadas de uso del monedero."
                                               wrapText="true"
                                               styleClass="hint-label"/>

                                        <HBox alignment="CENTER_RIGHT">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <Button fx:id="btnEjecutarAnalisis"
                                                        text="Ejecutar análisis"
                                                        onAction="#handleEjecutarAnalisis"
                                                        styleClass="primary-button"/>
                                            </children>
                                        </HBox>
                                    </children>
                                </VBox>
                            </content>
                        </Tab>

                    </tabs>
                </TabPane>

            </children>
        </HBox>
    </center>

    <!-- =============== LOG / ACTIVIDAD ================= -->
    <bottom>
        <VBox styleClass="log-panel"
              BorderPane.alignment="CENTER">
            <padding>
                <Insets top="0" right="20" bottom="20" left="20"/>
            </padding>
            <spacing>6</spacing>
            <children>
                <Label text="Actividad y notificaciones"
                       styleClass="card-title"/>
                <TextArea fx:id="areaLog"
                          editable="false"
                          wrapText="true"
                          prefRowCount="4"
                          VBox.vgrow="ALWAYS"/>
            </children>
        </VBox>
    </bottom>

</BorderPane>
